from random import randint
import io

male_file_path = "./Resources/male_names.txt"
female_file_path = "./Resources/female_names.txt"

male_result_file_path =  "./Extracts/males.txt"
female_result_file_path =  "./Extracts/females.txt"

male_list = []
female_list = []
all_list = [male_list, female_list]
all_male_list = []
all_female_list = []

with open(male_file_path, "r") as male_file:
    for line in male_file:
        male_list.append(line.split(" ", 1)[0].strip().capitalize())
    male_list.sort()

with open(female_file_path, "r") as female_file:
    for line in female_file:
        female_list.append(line.split(" ", 1)[0].strip().capitalize())
    female_list.sort()


for idx, g_list in enumerate(all_list):
    for f_idx, first_name in enumerate(g_list):
        for l_idx in range(len(g_list)):
            last_name_idx = randint(0, len(g_list) - 1)
            while last_name_idx == f_idx:
                last_name_idx = randint(0, len(g_list) - 1)

            last_name = g_list[last_name_idx]
            if idx == 0:
                all_male_list.append("{0} {1}".format(first_name, last_name))
            else:
                all_female_list.append("{0} {1}".format(first_name, last_name))

with open(male_result_file_path, "w") as m_res_file:
    m_res_file.writelines("\n".join(all_male_list))

with open(female_result_file_path, "w") as f_res_file:
    f_res_file.writelines("\n".join(all_female_list))

print "COMPLETE"